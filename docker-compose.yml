version: '3.8'

services:
  transcription-service:
    build:
      context: .
      args:
        WHISPER_MODEL: ${WHISPER_MODEL:-small}
    image: email-transcription:latest
    container_name: email-transcription
    env_file:
      - .env
    command: ["python", "-u", "-m", "app.main", "--mode", "daemon"]
    restart: unless-stopped
    volumes:
      - ./logs:/app/logs
      - ./app:/app/app
    mem_limit: ${MEMORY_LIMIT:-8g}
